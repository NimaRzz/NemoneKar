@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Add";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<div class="row w-100">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-body">
                <h4 class="mt-0 header-title">افزودن سرنخ جدید</h4>

                <div class="row">
                    <div class="col-lg-6">
                        <div class="form-group row">
                            <label for="customer" class="col-sm-2 col-form-label text-right">مشتری:</label>
                                <select class="form-select" name="customer" id="customer" asp-items="@ViewBag.Customers"></select>
                        </div>
                        <div class="form-group row">
                            <label for="description" class="col-sm-2 col-form-label text-right">توضیحات:</label>
                                <textarea class="form-control" id="description" rows="3"></textarea>
                        </div>

                        <div class="form-group row">
                            <label for="date" class="col-sm-2 col-form-label text-right">تاریخ:</label>
                            <div class="col-sm-10">
                                <input class="form-control" type="text" id="date">
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-10">
                                <button class="btn btn-success" id="addButton" onclick="AddCue()">افزودن</button>
                            </div>
                        </div>

                    </div>


                </div>
            </div><!--end card-body-->
        </div><!--end card-->
    </div><!--end col-->
</div>

@section Scripts {

    <link href="~/Sweetalert2/sweetalert2.min.css" rel="stylesheet" />
    <script src="~/Sweetalert2/sweetalert2.min.js"></script>

    <script>

        function AddCue() {


            swal.fire({
                title: 'افزودن سرنخ جدید',
                text: 'از افزودن سرنخ جدید مطمئن هستید؟',
                icon: 'info',
                showCancelButton: true,
                cancelButtonColor: '#fc0000',
                confirmButtonColor: '#039e00',
                cancelButtonText: 'خیر',
                confirmButtonText: 'بله، افزودن سرنخ جدید انجام شود'

            }).then((result) => {
                if (result.value) {


                    var data = new FormData();

                    data.append('CustomerId', $("#customer").val());
                    data.append('Description', $("#description").val());
                    data.append('Date', $("#date").val());
                 
                    console.log(data);
                }


                $.ajax({
                    type: 'POST',
                    contentType: false,
                    processData: false,
                    url: '/admin/cues/Add',
                    data: data,
                    success: function (data) {
                        if (data.isSuccess == true) {
                            swal.fire(
                                'موفق',
                                data.message,
                                'success'
                            ).then(function (isConfirm) {

                                window.location.replace("/admin/cues");

                            });
                        }
                        else {
                            swal.fire(
                                'هشدار',
                                data.message,
                                'warning'
                            );
                        }
                    },
                    error: function (xhr, ajaxOption, thrownError) {

                        alert(xhr.status);
                        alert(thrownError);

                    }

                });

            })
        }

       
       
         kamaDatepicker('date', {

            placeholder: 'YYYY/MM/DD',
            format: 'YYYY/MM/DD',
            closeAfterSelect: false,
            forceFarsiDigits: true,
            markToday: true,
            markHolidays: true,
            highlightSelectedDay: true,
            gotoToday: true

        });

        
        
        

    </script>

}